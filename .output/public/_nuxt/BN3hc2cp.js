import{T as K}from"./BAHNGNGe.js";import{g as w,C as F,o as u,c,a as e,t as x,x as P,D as Q,u as s,F as $,r as O,z as q,E as j,y as G,G as D,k as g,H as z,n as C,I as S,d as k,v as R,b as n,J as T,q as B,K as E,L as N,M as L,N as X,O as Y,P as Z,Q as ee,R as te,S as se,T as le,U as oe,w as M,V as ae,W as ne,e as ie,X as re,Y as de}from"./Dpvjcl7r.js";import{_ as I,a as J}from"./DcL4xQ15.js";import{u as ue}from"./V1jC1RQ-.js";import{_ as ce}from"./CyOyDTfm.js";import"./CPced3FP.js";const me={class:"relative mb-2"},pe={class:"block text-sm"},ve=["required"],W=w({__name:"picker",props:{modelValue:String,label:String,items:Array,required:Boolean},emits:["update:modelValue"],setup(m,{emit:b}){const v=m,y=b,t=F({get:()=>v.modelValue,set:r=>y("update:modelValue",r)});return(r,a)=>(u(),c("div",me,[e("label",pe,x(m.label),1),P(e("select",{"onUpdate:modelValue":a[0]||(a[0]=p=>q(t)?t.value=p:null),required:m.required,class:"h-10 input-control"},[(u(!0),c($,null,O(m.items,(p,_)=>(u(),c("option",{key:_},x(p),1))),128))],8,ve),[[Q,s(t)]])]))}}),fe={class:"relative mb-2"},_e={class:"block text-sm"},ye=["type","required"],be=["required"],H=w({__name:"textfield",props:{modelValue:String,label:String,type:String,required:Boolean,textarea:Boolean},emits:["update:modelValue"],setup(m,{emit:b}){const v=m,y=b,t=F({get:()=>v.modelValue,set:r=>y("update:modelValue",r)});return(r,a)=>(u(),c("div",fe,[e("label",_e,x(m.label),1),m.textarea?P((u(),c("textarea",{key:1,rows:"2","onUpdate:modelValue":a[1]||(a[1]=p=>q(t)?t.value=p:null),required:m.required,class:"input-control pt-2 resize-none"},null,8,be)),[[G,s(t)]]):P((u(),c("input",{key:0,"onUpdate:modelValue":a[0]||(a[0]=p=>q(t)?t.value=p:null),type:m.type,required:m.required,class:"h-10 input-control"},null,8,ye)),[[j,s(t)]])]))}}),he=e("i",{class:"fas fa-edit text-lg"},null,-1),xe=[he],ge=e("i",{class:"fas fa-plus-circle text-xl mr-1"},null,-1),Ve={key:2,class:"fixed inset-0 bg-black/50 overflow-hidden overflow-y-auto"},$e={class:"sm bg-white min-h-screen"},ke={class:"h-14 bb flex items-center pl-4"},qe=e("div",{class:"text-xl font-black pr-3 flex-1"},"Create Shipment",-1),we=e("i",{class:"fas fa-times text-2xl"},null,-1),Ce=[we],Se={class:"p-6"},Ue={class:"py-2"},Ae=e("h3",{class:"text-sm font-bold uppercase mb-1"},"Origin",-1),De={class:"py-2"},Ne=e("h3",{class:"text-sm font-bold uppercase mb-1"},"Destination",-1),Pe={class:"py-2"},Te=e("h3",{class:"text-sm font-bold uppercase mb-1"},"Product detail",-1),Oe={class:"grid grid-cols-2 gap-4"},Be=w({__name:"create",props:{item:Object,edit:Boolean},setup(m){const b=m,{$db:v}=D(),y=g(!1);z(y,L);const t=g(b.item),r=g(!1),a=g(!1),p=g(!1),_=["Air Freight","Ocean Freight","Road Freight","Rail Freight"];async function f(){r.value=!0,b.edit||(t.value.updates=[{status:"Recipient notified via email about delivery details",country:t.value.sender.country,city:t.value.sender.city,date:d(t.value.sender.departure,38)},{status:"In process at terminal",country:t.value.sender.country,city:t.value.sender.city,date:d(t.value.sender.departure,22)},{status:"Shipment information received",country:t.value.sender.country,city:t.value.sender.city,date:d(t.value.sender.departure,7)},{status:"Shipment received at terminal",country:t.value.sender.country,city:t.value.sender.city,date:t.value.sender.departure}]);try{await E(N(v,"trackings",t.value.id),t.value),a.value=!0,y.value=!1}catch{p.value=!0}finally{r.value=!1}}function d(h,l){const V=new Date(`${h}:00.000Z`);return new Date(V.getTime()+l*6e4).toISOString().split(":00.")[0]}return(h,l)=>{const V=W,i=H,U=I,A=J;return u(),c($,null,[m.edit?(u(),c("button",{key:0,onClick:l[0]||(l[0]=o=>y.value=!s(y)),style:C(("squared"in h?h.squared:s(S))(38)),title:"Edit shipment",class:"hover:text-primary text-zinc-600 hover:bg-secondary"},xe,4)):(u(),c("button",{key:1,onClick:l[1]||(l[1]=o=>y.value=!s(y)),class:"uppercase text-sm font-bold text-error hover:text-white hover:bg-error px-3 py-1 place-center border border-error"},[ge,k(" Create ")])),s(y)?(u(),c("div",Ve,[e("div",$e,[e("div",ke,[qe,e("div",{class:"place-center p-5 cursor-pointer",onClick:l[2]||(l[2]=o=>y.value=!1)},Ce)]),e("div",Se,[e("form",{class:"xs",ref:"form",onSubmit:R(f,["prevent"])},[n(V,{modelValue:s(t).type,"onUpdate:modelValue":l[3]||(l[3]=o=>s(t).type=o),required:"",label:"Handled by",items:_},null,8,["modelValue"]),e("section",Ue,[Ae,n(i,{modelValue:s(t).sender.name,"onUpdate:modelValue":l[4]||(l[4]=o=>s(t).sender.name=o),required:"",label:"Sender's Name"},null,8,["modelValue"]),n(i,{modelValue:s(t).sender.city,"onUpdate:modelValue":l[5]||(l[5]=o=>s(t).sender.city=o),required:"",label:"City of origin"},null,8,["modelValue"]),n(V,{modelValue:s(t).sender.country,"onUpdate:modelValue":l[6]||(l[6]=o=>s(t).sender.country=o),required:"",label:"Country of origin",items:"countries"in h?h.countries:s(T)},null,8,["modelValue","items"]),n(i,{modelValue:s(t).sender.departure,"onUpdate:modelValue":l[7]||(l[7]=o=>s(t).sender.departure=o),required:"",type:"datetime-local",label:"Departure date & time"},null,8,["modelValue"])]),e("section",De,[Ne,n(i,{modelValue:s(t).receiver.name,"onUpdate:modelValue":l[8]||(l[8]=o=>s(t).receiver.name=o),required:"",label:"Receiver's Name"},null,8,["modelValue"]),n(i,{modelValue:s(t).receiver.city,"onUpdate:modelValue":l[9]||(l[9]=o=>s(t).receiver.city=o),required:"",label:"City of receiver"},null,8,["modelValue"]),n(V,{modelValue:s(t).receiver.country,"onUpdate:modelValue":l[10]||(l[10]=o=>s(t).receiver.country=o),required:"",label:"Country of receiver",items:"countries"in h?h.countries:s(T)},null,8,["modelValue","items"]),n(i,{modelValue:s(t).receiver.delivery,"onUpdate:modelValue":l[11]||(l[11]=o=>s(t).receiver.delivery=o),required:"",type:"datetime-local",label:"Arrival date & time"},null,8,["modelValue"])]),e("section",Pe,[Te,n(i,{modelValue:s(t).details.product,"onUpdate:modelValue":l[12]||(l[12]=o=>s(t).details.product=o),required:"",label:"Product Name"},null,8,["modelValue"]),e("div",Oe,[n(i,{type:"number",modelValue:s(t).details.quantity,"onUpdate:modelValue":l[13]||(l[13]=o=>s(t).details.quantity=o),label:"Quantity"},null,8,["modelValue"]),n(i,{modelValue:s(t).details.weight,"onUpdate:modelValue":l[14]||(l[14]=o=>s(t).details.weight=o),label:"Weight (Kg)"},null,8,["modelValue"])]),n(i,{textarea:"",modelValue:s(t).details.desc,"onUpdate:modelValue":l[15]||(l[15]=o=>s(t).details.desc=o),label:"Comments"},null,8,["modelValue"])]),n(U,{modelValue:s(p),"onUpdate:modelValue":l[16]||(l[16]=o=>q(p)?p.value=o:null),error:"",msg:"An error occured. Please try again later!"},null,8,["modelValue"]),n(U,{modelValue:s(a),"onUpdate:modelValue":l[17]||(l[17]=o=>q(a)?a.value=o:null),success:"",msg:"Shipment created succefully!"},null,8,["modelValue"]),n(A,{value:m.edit?"Update shipment":"Create shipment",loading:s(r)},null,8,["value","loading"])],544)])])])):B("",!0)],64)}}}),Ee={key:0,class:"fixed z-50 inset-0 bg-black/50 overflow-hidden overflow-y-auto"},Me={class:"sm bg-white"},Fe={class:"h-14 bb flex items-center pl-4"},ze=e("div",{class:"text-xl font-black pr-3 flex-1"},"Create an Update",-1),Re=e("i",{class:"fas fa-times text-2xl"},null,-1),Le=[Re],Ie={class:"p-6"},Je=e("div",{class:"text-xs mb-2 font-bold opacity-90"}," Please add the status and current location of this shipment. ",-1),We=w({__name:"update",props:["item"],setup(m){const b=m,v=g(!1),{$db:y}=D(),t=g({status:"",country:"",city:"",date:""}),r=g(!1),a=g(!1);async function p(){r.value=!0;const _={...b.item,updates:[t.value,...b.item.updates]};try{await E(N(y,"trackings",b.item.id),_),v.value=!1,t.value={status:"",country:"",city:"",date:""}}catch{a.value=!0}finally{r.value=!1}}return(_,f)=>{const d=H,h=W,l=I,V=J;return u(),c($,null,[e("button",{onClick:f[0]||(f[0]=i=>v.value=!s(v)),class:"border text-error border-error hover:bg-error/5 font-bold text-sm w-full px-6 h-8"}," Create update "),s(v)?(u(),c("div",Ee,[e("div",Me,[e("div",Fe,[ze,e("div",{class:"place-center p-5 cursor-pointer",onClick:f[1]||(f[1]=i=>v.value=!1)},Le)]),e("div",Ie,[e("form",{class:"xs",ref:"form",onSubmit:R(p,["prevent"])},[Je,n(d,{modelValue:s(t).status,"onUpdate:modelValue":f[2]||(f[2]=i=>s(t).status=i),required:"",label:"Status"},null,8,["modelValue"]),n(d,{modelValue:s(t).city,"onUpdate:modelValue":f[3]||(f[3]=i=>s(t).city=i),required:"",label:"City"},null,8,["modelValue"]),n(h,{modelValue:s(t).country,"onUpdate:modelValue":f[4]||(f[4]=i=>s(t).country=i),required:"",label:"Country",items:"countries"in _?_.countries:s(T)},null,8,["modelValue","items"]),n(d,{modelValue:s(t).date,"onUpdate:modelValue":f[5]||(f[5]=i=>s(t).date=i),required:"",type:"datetime-local",label:"Date & time",class:"mb-4"},null,8,["modelValue"]),n(l,{modelValue:s(a),"onUpdate:modelValue":f[6]||(f[6]=i=>q(a)?a.value=i:null),error:"",msg:"An error occured. Please try again later!"},null,8,["modelValue"]),n(V,{value:"Add Update",loading:s(r)},null,8,["loading"])],544)])])])):B("",!0)],64)}}}),He={key:0,class:"fixed inset-0 bg-black/50 overflow-hidden overflow-y-auto"},Ke={class:"sm bg-white min-h-screen"},Qe={class:"h-14 bb flex items-center pl-4"},je=e("div",{class:"text-xl font-black pr-3 flex-1"},"Shipment Updates",-1),Ge=e("i",{class:"fas fa-times text-2xl"},null,-1),Xe=[Ge],Ye={class:"px-6 py-2 bb bg-secondary"},Ze={class:"py-3 bb flex px-3"},et={class:"px-3 text-sm flex-1"},tt={class:"opacity-80 text-xs mb-1"},st={class:"font-bold"},lt=["onClick"],ot=e("i",{class:"fal fa-trash-alt text-xl"},null,-1),at=[ot],nt=w({__name:"movements",props:["item"],setup(m){const b=m,v=g(!1),{$db:y}=D();z(v,L);async function t(r){if(!confirm("Are you sure you want to remove update?"))return;const a={...b.item,updates:[...b.item.updates].filter(p=>JSON.stringify(r)!=JSON.stringify(p))};try{await E(N(y,"trackings",b.item.id),a)}catch(p){alert(ee(p.code))}}return(r,a)=>{const p=We;return u(),c($,null,[e("button",{onClick:a[0]||(a[0]=_=>v.value=!s(v)),class:"border text-error hover:bg-error/5 font-bold text-sm w-full px-12 h-8"}," Shipment Updates "),s(v)?(u(),c("div",He,[e("div",Ke,[e("div",Qe,[je,e("div",{class:"place-center p-5 cursor-pointer",onClick:a[1]||(a[1]=_=>v.value=!1)},Xe)]),e("div",Ye,[n(p,{item:m.item},null,8,["item"])]),e("div",null,[(u(!0),c($,null,O(m.item.updates.sort("sort_date"in r?r.sort_date:s(Z)),_=>(u(),c("div",Ze,[e("div",et,[e("div",tt,x(("get_day"in r?r.get_day:s(X))(_.date))+" "+x(("get_datetime"in r?r.get_datetime:s(Y))(_.date))+" (Local time) ",1),e("h4",st,x(_.status),1),e("h5",null,x(_.city)+", "+x(_.country),1)]),e("div",{class:"place-center p-3 cursor-pointer",onClick:f=>t(_)},at,8,lt)]))),256))])])])):B("",!0)],64)}}}),it={class:"p-4 bt bg-[#fcfefc]"},rt={class:"md sm:py-6"},dt={class:"flex mb-4 -ml-2 items-center text-xs sm:text-sm"},ut=e("i",{class:"fas fa-home mt-1"},null,-1),ct=e("i",{class:"fas fa-angle-right text-base text-error mt-1"},null,-1),mt=e("span",{class:"opacity-80 p-2"},"Extranet",-1),pt={class:"flex shadow ba p-4 mb-4"},vt={class:"flex-1 flex items-center"},ft={class:"pl-4"},_t=e("div",{class:"text-xl sm:text-2xl font-black"},"Welcome!",-1),yt={class:"text-base sm:text-lg"},bt={class:"py-3 flex"},ht=e("h2",{class:"text-xl sm:text-2xl uppercase font-black flex-1"}," Shipments ",-1),xt={key:0,class:"place-center"},gt=e("img",{src:ce,width:"280"},null,-1),Vt=[gt],$t={key:1},kt={class:"p-4"},qt={class:"flex"},wt={class:"flex-1 flex flex-col gap-2 text-sm"},Ct={class:"flex"},St=["onClick"],Ut=e("i",{class:"fas fa-trash-alt text-lg"},null,-1),At=[Ut],Dt={class:"pt-3"},Nt={key:2,class:"ba p-6 shadow-inner flex items-center text-center"},Pt=e("i",{class:"fas fa-exclamation-triangle text-error text-2xl"},null,-1),Tt=e("div",{class:"text-base pl-4"}," An error occured. Please check your connection and try again later. ",-1),Ot=[Pt,Tt],Bt={key:3,class:"ba p-6 text-center shadow-inner"},Et=e("i",{class:"fas fa-exclamation-triangle text-error text-5xl"},null,-1),Mt=e("div",{class:"text-sm sm:text-lg pt-3"}," No record can be found at this time. ",-1),Ft=[Et,Mt],Kt=w({__name:"extranet",setup(m){const{$db:b}=D(),v=g(!0),y=g(!1),t=g([]),r=te(),a=ue("cpanelex_user"),p={id:Date.now().toString().slice(0,10),type:"Air Freight",author:a.value.uid,sender:{name:"",city:"",country:"",date:"",departure:""},receiver:{name:"",city:"",country:"",date:"",delivery:""},details:{product:"",quantity:"",weight:"",desc:""},updates:[]};se(async()=>{le(oe(b,"trackings"),d=>{t.value=[],d.forEach(h=>{a.value.uid==h.data().author&&t.value.push({...h.data(),id:h.id})}),v.value=!1})});async function _(d){try{confirm("Are you sure you want to delete shipment: "+d+"?")&&await de(N(b,"trackings",d))}catch{alert("An error occured. Please try again!")}}function f(){confirm("Are you sure you want to Sign Out")&&ae(r).then(()=>{a.value=null,ne({path:"/"})}).catch(()=>{alert("An error occured. Please try again later!")})}return(d,h)=>{var A;const l=K,V=ie,i=Be,U=nt;return u(),c($,null,[n(l,null,{default:M(()=>[k("Extranet")]),_:1}),e("section",it,[e("div",rt,[e("div",dt,[n(V,{to:"/",class:"p-2 block hover:text-error"},{default:M(()=>[ut]),_:1}),ct,mt]),e("div",pt,[e("div",vt,[e("i",{style:C(("squared"in d?d.squared:s(S))(65)),class:"fas fa-user-circle text-4xl place-center bg-secondary"},null,4),e("div",ft,[_t,e("div",yt,x((A=s(a))==null?void 0:A.email),1)])]),e("button",{onClick:f,style:C(("squared"in d?d.squared:s(S))(55)),class:"-mt-4 -mr-4 hover:text-error text-zinc-600"},[e("i",{style:C(("squared"in d?d.squared:s(S))(46)),class:"fas fa-sign-out-alt text-2xl place-center hover:bg-error/10"},null,4)],4)]),e("div",bt,[ht,n(i,{item:p})]),s(v)?(u(),c("section",xt,Vt)):s(t).length?(u(),c("section",$t,[(u(!0),c($,null,O(s(t),o=>(u(),c("div",{key:o.id,class:"ba mb-3"},[e("div",kt,[e("div",qt,[e("div",wt,[e("div",null,[k(" Tracking Code: "),e("b",null,x(o.id),1)]),e("div",null,[k(" Customer: "),e("b",null,x(o.receiver.name),1)]),e("div",null,[k(" Destination: "),e("b",null,x(o.receiver.city)+", "+x(o.receiver.country),1)]),e("div",null,[k(" Status: "),e("b",null,x(("get_update"in d?d.get_update:s(re))(o.updates).status),1)])]),e("div",Ct,[n(i,{edit:"",item:o},null,8,["item"]),e("button",{style:C(("squared"in d?d.squared:s(S))(38)),title:"Delete shipment",onClick:zt=>_(o.id),class:"text-error hover:bg-secondary -mr-2"},At,12,St)])]),e("div",Dt,[n(U,{item:o},null,8,["item"])])])]))),128))])):s(y)?(u(),c("section",Nt,Ot)):(u(),c("section",Bt,Ft))])])],64)}}});export{Kt as default};
